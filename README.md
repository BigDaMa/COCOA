# COCOA
Data enrichment, also known as horizontal data augmentation, is an important element in many preprocessing pipelines, especially if the dataset at hand does not contain the related information for the user's machine learning (ML) application. Current data augmentation solutions enrich the input dataset with joinable tables, i.e., features that are related to the domain of the given dataset.
However, they do not take into account the downstream ML application leading to lower downstream accuracy and requiring extensive feature selection techniques on top.
Using large database repositories for feature extraction typically results in a large number of feature candidates and requires a more restrictive enrichment process that not only verifies the relatedness of features but also their informativeness to unburden the feature selection process. 
In this paper, we propose COCOA a data augmentation solution that supports the downstream ML task by taking into account the correlation of the extracted features to the target of the ML application.
To generalize our solution to large scale repositories with millions of tables, we also introduce a new index structure that enables the system to detect non-linear correlations between external features with the user-defined target column in linear time complexity.
Our index structure, thus, leads to a faster and more scalable enrichment process.
Our experimental results show that our index structure allows us to enrich the data at hand hundreds of times faster than current correlation-driven augmentation solutions.

## Using the system
The project contains three main python files: index_generation.py, COCOA.py, and SBE.py.
index_generation.py is responsible to generate the inverted index and also the order index out of the tables stored in the DB. These index structures are used to efficiently find the joinable external tables and calculate the non-linear correlation between the external columns and the ML task target column. COCOA calculates the non-linear correlation in a linear time complexity.
SBE.py contains methods to find the joinable tables using the inverted index generated by "generate_inverted_index()" function in index_generation.py. "enrich_SBE()" function, based on the provided parameters, enriches the given dataset. "enrich_COCOA()" function in COCOA.py enriches the input dataset in the same way except COCOA leveraging the order index generated by "generate_order_index()" function in index_generation.py.

Having the tables stored in the DB based on the tokenisation suggested in the DataXFormer system [1], the functions should be called in this order:

```
generate_inverted_index()

generate_order_index()

enrich_COCOA('movie', 'movie_title', 'imdb_score', 50, 10000)
enrich_COCOA('pageviews', 'name', 'visit', 50, 10000)
enrich_COCOA('presidential', 'County', 'Votets', 50, 10000)
enrich_COCOA('universities', 'name', 'target', 50, 10000)
enrich_COCOA('worldcitiespop', 'City', 'Population', 50, 10000)
``` 
Parameters of enrich_COCOA function are name of the dataset, the query column, the target column (the ML model. Prediction column), the number of final columns to enrich the input dataset with, and the number of external tables to fetch and to look for the best correlating columns in.

## References
[1] Z. Abedjan, J. Morcos, M. N. Gubanov, I. F. Ilyas,M. Stonebraker, P. Papotti, and M. Ouzzani. Dataxformer:  Leveraging the web for semantic transformations. In CIDR, 2015.